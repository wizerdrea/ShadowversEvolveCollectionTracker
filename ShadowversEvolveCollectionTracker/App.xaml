<Application x:Class="ShadowverseEvolveCardTracker.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:ShadowverseEvolveCardTracker"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <ResourceDictionary>

            <!-- Shadowverse Evolve Color Palette -->
            <Color x:Key="ColorPrimary">#0A1628</Color>
            <!-- deep navy background -->
            <Color x:Key="ColorSurface">#0D1F35</Color>
            <!-- slightly lighter navy -->
            <Color x:Key="ColorElevated">#132A45</Color>
            <!-- elevated surface -->
            <Color x:Key="ColorBorder">#1E3A5F</Color>
            <!-- subtle blue border -->
            <Color x:Key="ColorAccent">#2DD4BF</Color>
            <!-- cyan/teal accent -->
            <Color x:Key="ColorAccentLight">#5EEAD4</Color>
            <!-- lighter cyan -->
            <Color x:Key="ColorGold">#D4AF37</Color>
            <!-- gold accent from logo -->
            <Color x:Key="ColorGoldLight">#F4D03F</Color>
            <!-- lighter gold -->
            <Color x:Key="ColorTextPrimary">#E8F4F8</Color>
            <!-- light blue-white -->
            <Color x:Key="ColorTextSecondary">#94A3B8</Color>
            <!-- muted blue-gray -->
            <Color x:Key="ColorHover">#0F2438</Color>
            <!-- hover state -->
            <Color x:Key="ColorSelected">#1A4D6D</Color>
            <!-- selection state -->
            <Color x:Key="ColorAccent40">#402DD4BF</Color>
            <Color x:Key="ColorAccent00">#002DD4BF</Color>
            <Color x:Key="ColorAccentLight60">#605EEAD4</Color>
            <Color x:Key="ColorAccentLight40">#405EEAD4</Color>
            <Color x:Key="ColorAccentLight30">#305EEAD4</Color>
            <Color x:Key="ColorGold50">#50D4AF37</Color>
            <Color x:Key="ColorGold40">#40D4AF37</Color>

            <!-- Brushes -->
            <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource ColorPrimary}" />
            <SolidColorBrush x:Key="SurfaceBrush" Color="{StaticResource ColorSurface}" />
            <SolidColorBrush x:Key="ElevatedBrush" Color="{StaticResource ColorElevated}" />
            <SolidColorBrush x:Key="BorderBrush" Color="{StaticResource ColorBorder}" />
            <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource ColorAccent}" />
            <SolidColorBrush x:Key="AccentLightBrush" Color="{StaticResource ColorAccentLight}" />
            <SolidColorBrush x:Key="GoldBrush" Color="{StaticResource ColorGold}" />
            <SolidColorBrush x:Key="GoldLightBrush" Color="{StaticResource ColorGoldLight}" />
            <SolidColorBrush x:Key="TextPrimaryBrush" Color="{StaticResource ColorTextPrimary}" />
            <SolidColorBrush x:Key="TextSecondaryBrush" Color="{StaticResource ColorTextSecondary}" />
            <SolidColorBrush x:Key="HoverBrush" Color="{StaticResource ColorHover}" />
            <SolidColorBrush x:Key="SelectedBrush" Color="{StaticResource ColorSelected}" />
            <SolidColorBrush x:Key="AccentLight60Brush" Color="{StaticResource ColorAccentLight60}" />
            <SolidColorBrush x:Key="AccentLight40Brush" Color="{StaticResource ColorAccentLight40}" />
            <SolidColorBrush x:Key="AccentLight30Brush" Color="{StaticResource ColorAccentLight30}" />
            <SolidColorBrush x:Key="Gold50Brush" Color="{StaticResource ColorGold50}" />
            <SolidColorBrush x:Key="Gold40Brush" Color="{StaticResource ColorGold40}" />

            <!-- Gradient brushes for premium look -->
            <LinearGradientBrush x:Key="HeaderGradientBrush" StartPoint="0,0" EndPoint="1,0">
                <GradientStop Color="{StaticResource ColorElevated}" Offset="0"/>
                <GradientStop Color="{StaticResource ColorSurface}" Offset="1"/>
            </LinearGradientBrush>

            <!-- Global font -->
            <FontFamily x:Key="AppFont">Segoe UI</FontFamily>

            <!-- Window style with custom chrome -->
            <Style TargetType="Window">
                <Setter Property="Background" Value="{StaticResource PrimaryBrush}" />
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
                <Setter Property="FontFamily" Value="{StaticResource AppFont}" />
                <Setter Property="FontSize" Value="12" />
                <Setter Property="WindowStyle" Value="SingleBorderWindow"/>
                <Setter Property="UseLayoutRounding" Value="True"/>
            </Style>

            <!-- ScrollBar Styles -->
            <Style x:Key="ScrollBarThumb" TargetType="Thumb">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Thumb">
                            <Border Background="{StaticResource BorderBrush}" 
                                    CornerRadius="4"
                                    BorderThickness="0"/>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="ScrollBarPageButton" TargetType="RepeatButton">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="RepeatButton">
                            <Border Background="Transparent"/>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="ScrollBar">
                <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ScrollBar">
                            <Grid>
                                <Border Background="{TemplateBinding Background}" CornerRadius="4"/>
                                <Track x:Name="PART_Track" IsDirectionReversed="True">
                                    <Track.Thumb>
                                        <Thumb Style="{StaticResource ScrollBarThumb}"/>
                                    </Track.Thumb>
                                    <Track.IncreaseRepeatButton>
                                        <RepeatButton Style="{StaticResource ScrollBarPageButton}" Command="ScrollBar.PageDownCommand"/>
                                    </Track.IncreaseRepeatButton>
                                    <Track.DecreaseRepeatButton>
                                        <RepeatButton Style="{StaticResource ScrollBarPageButton}" Command="ScrollBar.PageUpCommand"/>
                                    </Track.DecreaseRepeatButton>
                                </Track>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="Orientation" Value="Horizontal">
                        <Setter Property="Height" Value="12"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ScrollBar">
                                    <Grid>
                                        <Border Background="{TemplateBinding Background}" CornerRadius="4"/>
                                        <Track x:Name="PART_Track" IsDirectionReversed="False">
                                            <Track.Thumb>
                                                <Thumb Style="{StaticResource ScrollBarThumb}"/>
                                            </Track.Thumb>
                                            <Track.IncreaseRepeatButton>
                                                <RepeatButton Style="{StaticResource ScrollBarPageButton}" Command="ScrollBar.PageRightCommand"/>
                                            </Track.IncreaseRepeatButton>
                                            <Track.DecreaseRepeatButton>
                                                <RepeatButton Style="{StaticResource ScrollBarPageButton}" Command="ScrollBar.PageLeftCommand"/>
                                            </Track.DecreaseRepeatButton>
                                        </Track>
                                    </Grid>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- Button: modern with cyan/gold accents -->
            <Style TargetType="Button">
                <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="12,6"/>
                <Setter Property="Margin" Value="4,2"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                                    <Setter Property="BorderBrush" Value="{StaticResource AccentLightBrush}"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Background" Value="{StaticResource SelectedBrush}"/>
                                    <Setter Property="BorderBrush" Value="{StaticResource GoldBrush}"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                    <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- TextBox: consistent with theme -->
            <Style TargetType="TextBox">
                <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="6,4"/>
                <Setter Property="Margin" Value="2"/>
                <Setter Property="CaretBrush" Value="{StaticResource AccentBrush}"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TextBox">
                            <Border Background="{TemplateBinding Background}" 
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="3"
                                    Padding="{TemplateBinding Padding}">
                                <ScrollViewer x:Name="PART_ContentHost"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsFocused" Value="True">
                                    <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- ComboBox Styles -->
            <Style x:Key="ComboBoxToggleButton" TargetType="ToggleButton">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToggleButton">
                            <Grid>
                                <Border Background="{StaticResource SurfaceBrush}" 
                                        BorderBrush="{StaticResource BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="3"/>
                                <Path x:Name="Arrow" 
                                      Data="M 0 0 L 4 4 L 8 0 Z"
                                      Fill="{StaticResource TextSecondaryBrush}"
                                      HorizontalAlignment="Right"
                                      Margin="0,0,6,0"
                                      VerticalAlignment="Center"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource AccentBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="ComboBox">
                <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="6,4"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ComboBox">
                            <Grid>
                                <ToggleButton x:Name="ToggleButton"
                                              Style="{StaticResource ComboBoxToggleButton}"
                                              Focusable="False"
                                              IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                              ClickMode="Press"/>
                                <ContentPresenter x:Name="ContentSite"
                                                  IsHitTestVisible="False"
                                                  Content="{TemplateBinding SelectionBoxItem}"
                                                  ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                  ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                  Margin="6,3,23,3"
                                                  VerticalAlignment="Center"
                                                  HorizontalAlignment="Left"/>
                                <Popup x:Name="Popup"
                                       Placement="Bottom"
                                       IsOpen="{TemplateBinding IsDropDownOpen}"
                                       AllowsTransparency="True"
                                       Focusable="False"
                                       PopupAnimation="Slide">
                                    <Grid x:Name="DropDown"
                                          SnapsToDevicePixels="True"
                                          MinWidth="{TemplateBinding ActualWidth}"
                                          MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                        <Border x:Name="DropDownBorder"
                                                Background="{StaticResource ElevatedBrush}"
                                                BorderBrush="{StaticResource AccentBrush}"
                                                BorderThickness="1"
                                                CornerRadius="4"
                                                Margin="0,2,0,0">
                                            <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                                <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                            </ScrollViewer>
                                        </Border>
                                    </Grid>
                                </Popup>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="ComboBoxItem">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="Padding" Value="8,4"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ComboBoxItem">
                            <Border Background="{TemplateBinding Background}"
                                    Padding="{TemplateBinding Padding}"
                                    CornerRadius="2">
                                <ContentPresenter/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                    </Trigger>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="{StaticResource SelectedBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- TabControl -->
            <Style TargetType="TabControl">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="0"/>
            </Style>

            <Style TargetType="TabItem">
                <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="1,1,1,0"/>
                <Setter Property="Padding" Value="16,8"/>
                <Setter Property="Margin" Value="0,0,2,0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4,4,0,0"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter ContentSource="Header"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource ElevatedBrush}"/>
                                    <Setter Property="Foreground" Value="{StaticResource GoldBrush}"/>
                                    <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- DataGrid -->
            <Style TargetType="DataGrid">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="RowBackground" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="AlternatingRowBackground" Value="{StaticResource ElevatedBrush}"/>
                <Setter Property="GridLinesVisibility" Value="None"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="HorizontalGridLinesBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="VerticalGridLinesBrush" Value="{StaticResource BorderBrush}"/>
            </Style>

            <Style TargetType="DataGridColumnHeader">
                <Setter Property="Background" Value="{StaticResource HeaderGradientBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource GoldBrush}"/>
                <Setter Property="Padding" Value="8,8"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="HorizontalContentAlignment" Value="Left"/>
            </Style>

            <Style TargetType="DataGridCell">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="8,6"/>
                <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="DataGridCell">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="{StaticResource SelectedBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <Style TargetType="DataGridRow">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                    </Trigger>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="{StaticResource SelectedBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- DataGrid Row Header (the selector column on the left) -->
            <Style TargetType="DataGridRowHeader">
                <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="0,0,1,0"/>
                <Setter Property="Width" Value="20"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="DataGridRowHeader">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}">
                                <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsRowSelected" Value="True">
                        <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource HoverBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- DataGrid Column Header Gripper (resize handle) -->
            <Style x:Key="ColumnHeaderGripperStyle" TargetType="Thumb">
                <Setter Property="Width" Value="8"/>
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Cursor" Value="SizeWE"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Thumb">
                            <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}"/>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Select All Button (top-left corner of DataGrid) -->
            <Style TargetType="{x:Type Button}" x:Key="{ComponentResourceKey TypeInTargetAssembly={x:Type DataGrid}, ResourceId=DataGridSelectAllButtonStyle}">
                <Setter Property="Background" Value="{StaticResource HeaderGradientBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <Border Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="0,0,1,1">
                                    <Polygon x:Name="Arrow"
                                             Fill="{StaticResource GoldBrush}"
                                             HorizontalAlignment="Right"
                                             VerticalAlignment="Bottom"
                                             Margin="0,0,4,4"
                                             Points="0,8 8,8 8,0"
                                             Stretch="Uniform"
                                             Width="8"
                                             Height="8"/>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource AccentBrush}"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource AccentLightBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- GridSplitter -->
            <Style TargetType="GridSplitter">
                <Setter Property="Background" Value="{StaticResource BorderBrush}"/>
            </Style>

            <!-- TextBlock -->
            <Style TargetType="TextBlock">
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            </Style>

            <!-- Brushes for checklist cell color triggers -->
            <SolidColorBrush x:Key="ChecklistLowBrush" Color="#1A4D4D"/>
            <!-- dark teal for low qty -->
            <SolidColorBrush x:Key="ChecklistHighBrush" Color="#2DD4BF"/>
            <!-- cyan accent for high qty -->

            <!-- Styles to theme Menu, ContextMenu and MenuItem dropdowns -->
            <Style TargetType="Menu">
                <Setter Property="Background" Value="{StaticResource ElevatedBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            </Style>

            <Style TargetType="ContextMenu">
                <Setter Property="Background" Value="{StaticResource ElevatedBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="4"/>
                <Setter Property="HasDropShadow" Value="True"/>
            </Style>

            <!-- Replace the existing MenuItem style with this improved MenuItem template -->
            <Style TargetType="MenuItem">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                <Setter Property="Padding" Value="8,4"/>
                <Setter Property="Margin" Value="0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="MenuItem">
                            <Grid>
                                <Border x:Name="Bd"
                  Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Padding="{TemplateBinding Padding}">
                                    <ContentPresenter ContentSource="Header" RecognizesAccessKey="True" VerticalAlignment="Center"/>
                                </Border>

                                <!-- Popup for sub-items: PlacementTarget binds to the MenuItem so the dropdown appears correctly -->
                                <Popup x:Name="SubMenuPopup"
                 Placement="Bottom"
                 PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                 AllowsTransparency="True"
                 Focusable="True"
                 IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                 StaysOpen="False"
                 PopupAnimation="Fade">
                                    <Border Background="{StaticResource ElevatedBrush}"
                    BorderBrush="{StaticResource AccentBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="4"
                    SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </Border>
                                </Popup>
                            </Grid>

                            <ControlTemplate.Triggers>
                                <Trigger Property="IsHighlighted" Value="True">
                                    <Setter TargetName="Bd" Property="Background" Value="{StaticResource HoverBrush}"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                </Trigger>

                                <Trigger Property="Role" Value="TopLevelHeader">
                                    <Setter TargetName="Bd" Property="Background" Value="Transparent"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Simple separator style used inside menus -->
            <Style TargetType="Separator" BasedOn="{StaticResource {x:Type Separator}}">
                <Setter Property="SnapsToDevicePixels" Value="True"/>
                <Setter Property="Margin" Value="4,4"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Separator">
                            <Border Background="{StaticResource BorderBrush}" Height="1" Margin="0,4"/>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </ResourceDictionary>
    </Application.Resources>
</Application>